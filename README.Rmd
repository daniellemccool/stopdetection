---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# stopdetection

<!-- badges: start -->
<!-- badges: end -->

This package implements the stop detection algorithm as outlined in Montoliu (2013). This package provides a set of tools to cluster timestamped movement trajectories into sets of stops (or staypoints) and tracks (or trajectories). Time-adjacent clusters are formed by first identifying stops on the basis of provided dwell time and radius parameters. A stop is created if all subsequent locations are within a certain distance of an initiating location for at least as long as the dwell time. For example, 200 meters and 5 minutes may be used in order to find all clusters within the trajectory for which a person remained within a circle with radius 200 meters for at least five minutes.

It is recommended to merge stops following the initial stop identification, as documented in ... FMS study .... Merging stops requires a parameter for the maximum distance away from each other that two stops may be while being considered the same stop. Single points between two stops adjacent in time are removed during this step. In data where locations are measured without error, this step is optional. Where locations are generated with error, this step provides an error correcting mechanism for erroneous and low-accuracy locations.

## Installation

You can install the development version of stopdetection from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("daniellemccool/stopdetection")
```

## Example

The following demonstrates the stopFinder algorithm with a distance radius parameter of 200 meters, and a minimum time parameter of 200 seconds.


```{r example}
library(data.table)
library(stopdetection)

df <- data.frame(entity_id = rep(1, 27),
   timestamp = c(1, 2, 4, 10, 14, 18, 20, 21, 24, 25, 28, 29, 45, 80, 100,
                 120, 200, 270, 300, 340, 380, 450, 455, 460, 470, 475,
                 490),
   longitude = c(5.1299311, 5.129979, 5.129597, 5.130028, 5.130555, 5.131083,
           5.132101, 5.132704, 5.133326, 5.133904, 5.134746, 5.135613,
           5.135613, 5.135613, 5.135613, 5.135613, 5.135613, 5.135613,
           5.135613, 5.135613, 5.135613, 5.135613, 5.134746, 5.133904,
           5.133326, 5.132704, 5.132101),
   latitude = c(52.092839, 52.092827, 52.092571, 52.092292, 52.092076, 52.091821,
           52.091420, 52.091219, 52.091343, 52.091651, 52.092138, 52.092698,
           52.092698, 52.092698, 52.092698, 52.092698, 52.092698, 52.092698,
           52.092698, 52.092698, 52.092698, 52.092138, 52.091651, 52.091343,
           52.091219, 52.091420, 52.091821))
setDT(df)
stopFinder(df, thetaD = 200, thetaT = 200)
df
```

